@(da : org.hadatac.entity.pojo.DataAcquisition, 
  permissions : Map[String, String],
  ownerOptions : List[String],
  schemas : List[org.hadatac.entity.pojo.DataAcquisitionSchema],
  bAdmin : Boolean)

@import helper._
@import org.hadatac.utils._
@import org.hadatac.console.views.html._
@import org.hadatac.console.controllers._
@import org.hadatac.console.controllers.dataacquisitionmanagement._

@main("Change Data Access Permission") {
	
	<script type="text/javascript">
		function checkform() {
		  var cansubmit = true;
	      if ($('#newParameter').value != '@da.getParameter()') {
	     	$('#div_acquisition_uri').show();
	     	$('#div_startdate').show();
	      }
		  if (document.getElementById('startdatetime').value.length == 0) {
	         cansubmit = false;
	      }
	      if (cansubmit) {
	          document.getElementById('submitbutton').disabled = false;
	      } else {
	          document.getElementById('submitbutton').disabled = 'disabled';
	      }
	   }
	</script>

    <h2>Edit Data Acquisition</h2>
    
    <div class="container-fluid">
       <ul>
       <li><b>URI:</b> @da.getUri()</li>
       <li><b>Status:</b> @da.getStatus()</li>
       <li><b>Triggering Event:</b> @da.getTriggeringEventName()</li>
       <li><b>Platform:</b> @da.getPlatformName()</li>
       <li><b>Instrument:</b> @da.getInstrumentModel()</li>
       <li><b>Start Date/Time:</b> @da.getStartedAt()</li>
       <li><b>End Date/Time:</b> @da.getEndedAt()</li>
       <li><b># of Data Points:</b> @da.getNumberDataPoints()</li>
       <li><b>Current Parameter:</b> @da.getParameter()</li>
       @if(bAdmin) {
       <li><b>Current Owner:</b> @da.getOwnerUri()</li>
       }
       <li><b>Current Permission:</b> @da.getPermissionUri()</li>

       <form class="form-horizontal" name="editForm" method="post" action="@org.hadatac.console.controllers.dataacquisitionmanagement.routes.EditDataAcquisition.processForm(da.getUri())">
       
       	 @if(bAdmin) {
		   <div class="form-group">
              <label>Set Owner</label>
              <select class="form-control col-sm-6" id="newOwner" name="newOwner" >
              	<option value=""></option>
            	@for(opt <- ownerOptions) {
                	@if(opt.equals(da.getOwnerUri())){
              	 		<option selected value="@opt">@opt</option>
              	 	} else {
              	 		<option value="@opt">@opt</option>
              	 	}
            	}
              </select>
           </div>
         }
           
           <div class="form-group">
              <label>Set Permission</label>
              <select class="form-control col-sm-6" id="newPermission" name="newPermission" >
              	 @if(da.getPermissionUri() != "Public"){
              		<option value="Public">Public</option> 
              	 }         
                 @for((permUri, permName) <- permissions){
                    @if(permUri.equals(da.getPermissionUri())) {
                    	<option selected value="@permUri">@permName</option>
              	 	} else {
              	 		<option value="@permUri">@permName</option>
              	 	}
                 }
              </select>
           </div>
           
           <div class="form-group">
              <label>Set Schema</label>
              <select class="form-control col-sm-6" id="newSchema" name="newSchema" >
              	<option value=""></option>
                @for(schema <- schemas){
                    @if(schema.equals(da.getSchemaUri())) {
                    	<option selected value="@schema.getUri()">@schema.getUri()</option>
              	 	} else {
              	 		<option value="@schema.getUri()">@schema.getUri()</option>
              	 	}
                 }
              </select>
           </div>
           
           <div class="form-group">
              <label>Set Parameter</label>
              <input type="text" value="@da.getParameter()" class="form-control" name="newParameter" id="newParameter" oninput="checkform()" >
           </div>
           
           <div id="div_acquisition_uri" class="form-group" style="display : none">
		   	  <label>Data Acquisition URI:</label>
 			  <input type="text" class="form-control col-sm-6" name="newDataAcquisitionUri" id="newDataAcquisitionUri" value="@da.getUri()">
 		   </div>
 		   
	 	  <div id="div_startdate" class="form-group" style="display : none">
	         <label for="startdate">Start Date/Time</label><br> 
	         <div class="container">
	            <div class="row">
	               <div class='col-sm-3'>
	                 <div class="form-group">
	                    <div class='input-group date' id='startdate' >
	                       <input type='text' name="newDataAcquisitionStartDate" id="newDataAcquisitionStartDate" class="form-control" />
	                       <span class="input-group-addon">
	                          <span class="glyphicon glyphicon-calendar"></span>
	                       </span>
	                    </div>
	                 </div>
	               </div>
	               <script type="text/javascript">
	                 $(function () {
	                     $('#startdate').datetimepicker();
	                     $('#startdate').on('dp.change', function (e) { checkform(); });
	                 });
	               </script>
	            </div>
	         </div>
	     </div>

           <div id="question-box">
              <br>
              Are your sure you want to commit changes to this data acquisition? 
              <input class="btn btn-success" id="submitbutton" role="button" type="submit" value="Confirm editing" />
           </div>
       </form>

       <br>
       <a href="@org.hadatac.console.controllers.dataacquisitionmanagement.routes.DataAcquisitionManagement.index(State.ACTIVE)" class="btn btn-primary" role="button">Back to Data Acquisition Management</a>

    </div>
    </ul>
}
